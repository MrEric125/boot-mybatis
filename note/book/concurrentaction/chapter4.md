chapter 4 ：
设计线程安全类的三个基本要素：
1. 找出构成对象状态的所有变量
2. 找出月梳妆台变量的不可变性条件
3. 建立对象状态的并发访问管理策略

要想确保类的线程安全，就需要确保它的不可变性条件不会再并发访问的情况下被破坏，如果在某个操作中包含了有基于状态的先验条件，那么这个操作就
称之为以来状态的操作（比如从一个队列中删除元素之前，必须判断其不为空）

为了防止多个线程在并发访问同一个对象时产生的相互干扰，这些对象应该要么是线程安全的，要么是事实不可变的对象，或者由锁来保护的对象

通过将封装机制与核实的加锁策略结合起来，可以确保以线程安全的方式来使用费线程安全的对象
将数据封装在对象内部，可以将数据的访问权限在对象的方法上，从而更容易确保线程在访问数据时总能持有正确的锁
